<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Done Waiting — Protect Our Schools</title>
  <meta name="description" content="Add your name: school shootings are unacceptable. Washington must act." />
  <meta property="og:title" content="Done Waiting — Protect Our Schools" />
  <meta property="og:description" content="Add your name: school shootings are unacceptable. Washington must act." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://www.donewaiting.us/" />
  <meta property="og:image" content="https://www.donewaiting.us/assets/og.jpg" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Done Waiting — Protect Our Schools" />
  <meta name="twitter:description" content="Add your name: school shootings are unacceptable. Washington must act." />
  <meta name="twitter:image" content="https://www.donewaiting.us/assets/og.jpg" />
  <style>
    :root{--bg:#0b0b0b;--fg:#f5f5f5;--muted:#b3b3b3;--border:#2a2a2a;--primary:#2563eb;--primary-2:#3b82f6;--field:#111111}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg)}
    .wrap{max-width:880px;margin:0 auto;padding:24px}
    .hero{padding:28px 0 10px}
    h1{font-size:clamp(26px,5vw,44px);line-height:1.1;margin:0 0 8px;text-wrap:balance;max-width:28ch}
    .bigline{font-weight:750;font-size:clamp(20px,4.2vw,34px);line-height:1.15;margin:4px 0;max-width:28ch}
    .muted{color:var(--muted)}
    .counter{font-weight:700}
    .hero-banner{position:relative;border-radius:16px;border:1px solid var(--border);overflow:hidden;height:300px;margin:12px 0}
    .hero-banner::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,#00000066,#000000aa),url('/assets/hero.jpg?v=1') center/cover no-repeat;filter:grayscale(25%) contrast(.95)}
    .sr{position:absolute;clip:rect(0,0,0,0);clip-path:inset(50%);width:1px;height:1px;overflow:hidden;white-space:nowrap}
    form{margin-top:8px}
    label{display:block}
    input,select{width:100%;padding:12px 14px;border-radius:10px;border:1px solid var(--border);background:var(--field);color:#fff;font-size:16px}
    .grid{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .grid-1{grid-template-columns:1fr}
    .row{display:flex;gap:8px;align-items:center}
    .btn{appearance:none;border:0;border-radius:12px;padding:14px 18px;font-weight:700;cursor:pointer}
    .btn-primary{background:linear-gradient(180deg,var(--primary-2),var(--primary));color:#fff;box-shadow:0 6px 20px #2563eb33}
    .btn:focus{outline:2px solid #3b82f666;outline-offset:2px}
  </style>
</head>
<body>
  <div class="wrap">
    <section class="hero" aria-label="Call to action">
      <h1>Is it unreasonable to say school shootings are a national problem?</h1>
<p class="bigline">Is doing nothing working?</p>
<p class="bigline">Add your name.</p>
<p class="muted">Takes ~10 seconds. Signatures so far: <span id="counter" class="counter">—</span></p>
      <div class="hero-banner" role="img" aria-label="Somber image reminding us what’s at stake"><span class="sr">Representative, non‑graphic photo</span></div>
    </section>

    <section aria-label="Sign the petition">
      <!-- state-only required, but we still include a hidden zip for backend compatibility -->
      <form id="petitionForm" method="POST" action="/api/sign?redirect=https://www.donewaiting.us/thank-you.html" class="grid grid-1" autocomplete="on">
        <input type="hidden" id="zipHidden" name="zip" value="99999"><!-- why: current API expects zip; use placeholder -->
        <div class="grid">
          <label>Name <span class="muted">(optional)</span>
            <input name="name" type="text" placeholder="Jane Doe" />
          </label>
          <label>Email <span class="muted">(optional)</span>
            <input name="email" type="email" placeholder="you@example.com" />
          </label>
        </div>
        <div class="grid">
          <label>State <span class="muted">(required)</span>
            <select name="state" id="state" required>
              <option value="" selected disabled>Choose a state</option>
              <option value="AL">Alabama</option>
              <option value="AK">Alaska</option>
              <option value="AZ">Arizona</option>
              <option value="AR">Arkansas</option>
              <option value="CA">California</option>
              <option value="CO">Colorado</option>
              <option value="CT">Connecticut</option>
              <option value="DE">Delaware</option>
              <option value="DC">District of Columbia</option>
              <option value="FL">Florida</option>
              <option value="GA">Georgia</option>
              <option value="HI">Hawaii</option>
              <option value="ID">Idaho</option>
              <option value="IL">Illinois</option>
              <option value="IN">Indiana</option>
              <option value="IA">Iowa</option>
              <option value="KS">Kansas</option>
              <option value="KY">Kentucky</option>
              <option value="LA">Louisiana</option>
              <option value="ME">Maine</option>
              <option value="MD">Maryland</option>
              <option value="MA">Massachusetts</option>
              <option value="MI">Michigan</option>
              <option value="MN">Minnesota</option>
              <option value="MS">Mississippi</option>
              <option value="MO">Missouri</option>
              <option value="MT">Montana</option>
              <option value="NE">Nebraska</option>
              <option value="NV">Nevada</option>
              <option value="NH">New Hampshire</option>
              <option value="NJ">New Jersey</option>
              <option value="NM">New Mexico</option>
              <option value="NY">New York</option>
              <option value="NC">North Carolina</option>
              <option value="ND">North Dakota</option>
              <option value="OH">Ohio</option>
              <option value="OK">Oklahoma</option>
              <option value="OR">Oregon</option>
              <option value="PA">Pennsylvania</option>
              <option value="RI">Rhode Island</option>
              <option value="SC">South Carolina</option>
              <option value="SD">South Dakota</option>
              <option value="TN">Tennessee</option>
              <option value="TX">Texas</option>
              <option value="UT">Utah</option>
              <option value="VT">Vermont</option>
              <option value="VA">Virginia</option>
              <option value="WA">Washington</option>
              <option value="WV">West Virginia</option>
              <option value="WI">Wisconsin</option>
              <option value="WY">Wyoming</option>
            </select>
          </label>
          <label class="row" style="gap:6px;align-items:center">
            <input type="checkbox" id="anon" name="anonymous" value="1" checked>
            <span>Sign anonymously</span>
          </label>
        </div>
        <button class="btn btn-primary" type="submit" aria-label="Sign the petition now">Sign in 1 step</button>
      </form>
    </section>
  </div>

  <script>
    window.addEventListener('DOMContentLoaded',()=>document.getElementById('state')?.focus());

    // Cache-bust count to avoid stale edge responses
    async function fetchCount(retries=2){
      const el=document.getElementById('counter');
      try{
        const res=await fetch('/api/count?t='+Date.now(),{cache:'no-store'});
        if(!res.ok) throw 0; const data=await res.json();
        el.textContent=new Intl.NumberFormat().format(Number(data?.count||0));
      }catch(e){ if(retries>0) return fetchCount(retries-1); el.textContent='—'; }
    }
    fetchCount();

    // Keep hidden zip present for current backend
    // Optional: set a state-coded dummy zip so analytics can group by state if needed
    const byStateZip={AL:'35005',AK:'99501',AZ:'85001',AR:'72201',CA:'90001',CO:'80014',CT:'06103',DE:'19701',DC:'20001',FL:'33101',GA:'30301',HI:'96801',ID:'83701',IL:'60601',IN:'46201',IA:'50301',KS:'66101',KY:'40201',LA:'70112',ME:'04101',MD:'21201',MA:'02108',MI:'48201',MN:'55401',MS:'39201',MO:'63101',MT:'59001',NE:'68102',NV:'89101',NH:'03301',NJ:'07101',NM:'87501',NY:'10001',NC:'27601',ND:'58102',OH:'43215',OK:'73102',OR:'97201',PA:'15219',RI:'02903',SC:'29201',SD:'57104',TN:'37201',TX:'73301',UT:'84101',VT:'05602',VA:'23219',WA:'98101',WV:'25301',WI:'53202',WY:'82001'};
    document.getElementById('state').addEventListener('change',(e)=>{
      const z=byStateZip[e.target.value]||'99999';
      document.getElementById('zipHidden').value=z;
    });

    document.getElementById('anon').addEventListener('change',(e)=>{
      const f=document.getElementById('petitionForm');
      let h=f.querySelector('input[name="anonymous"][type="hidden"]');
      if(!h){h=document.createElement('input');h.type='hidden';h.name='anonymous';f.appendChild(h);} h.value=e.target.checked?'1':'0';
    });
  </script>
</body>
</html>
```
